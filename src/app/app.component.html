<h1 class="text-center mt-5 scroll-m-20 text-4xl font-extrabold tracking-tight lg:text-5xl">Create your passive</h1>

<form (ngSubmit)="onSubmit()" class="flex flex-col m-5 py-5" [formGroup]="form">

  <!-- Stats -->
  <div class="flex items-center justify-center gap-1 px-20">
    <div class="flex flex-col flex-1 relative px-10">
      <label class="my-2 scroll-m-20 text-1xl font-extrabold tracking-tight lg:text-md" for="attack">Attack</label>
      <input placeholder="7777" class="pl-2" id="attack" formControlName="attack" type="number">
      @if ( form.get('attack')?.dirty && form.get('attack')?.getError('required')) {
      <app-error errorMessage="Attack field required" />
      }
    </div>
    <div class="flex flex-col flex-1">
      <label class="my-2 scroll-m-20 text-1xl font-extrabold tracking-tight lg:text-md" for="defense">Defense</label>
      <input placeholder="7777" class="pl-2" id="defense" formControlName="defense" type="number">
      @if ( form.get('defense')?.dirty && form.get('defense')?.getError('required')) {
      <app-error errorMessage="Defense field required" />
      }
    </div>
    <div class="flex flex-col flex-1 px-10">
      <label class="my-2 scroll-m-20 text-1xl font-extrabold tracking-tight lg:text-md" for="hp">HP</label>
      <input placeholder="7777" class="pl-2" id="hp" formControlName="hp" type="number">
      @if ( form.get('hp')?.dirty && form.get('hp')?.getError('required')) {
      <app-error errorMessage="HP field required" />
      }
    </div>
  </div>

  <!-- Legendary character ? -->
  <div class="flex flex-col items-start px-30">
    <label class="my-2 scroll-m-20 text-1xl font-extrabold tracking-tight lg:text-md" for="isLegendaryCharacter">LR
      ?</label>
    <select class="text-xl ml-0 text-center m-auto text-white mt-2 select" formControlName="isLegendaryCharacter"
      id="isLegendaryCharacter">
      <option [ngValue]="true">
        Yes
      </option>
      <option [ngValue]="false">
        No
      </option>
    </select>

  </div>

  <!-- Leader skill -->
  <div class="flex items-center justify-center gap-1 px-20 mt-5">
    <div class="flex flex-col flex-1 relative px-10">
      <label class="my-2 scroll-m-20 text-1xl font-extrabold tracking-tight lg:text-md" for="leaderSkill">Leader
        Skill</label>
      <input placeholder="'Universe 6' Category Ki +4 and HP, ATK & DEF +220%" class="pl-2" id="leaderSkill"
        formControlName="leaderSkill" type="text">
      @if ( form.get('leaderSkill')?.dirty && form.get('leaderSkill')?.getError('required')) {
      <app-error errorMessage="Leader skill field required" />
      }
    </div>

  </div>

  <!-- Super attack -->

  <div class="flex items-center justify-center gap-1 px-20 mt-5">
    <div class="flex flex-col flex-1 relative px-10">
      <label class="my-2 scroll-m-20 text-1xl font-extrabold tracking-tight lg:text-md" for="superAttack">Super
        Attack</label>
      <input
        placeholder="Raises ATK & DEF for 1 turn, causes colossal damage to enemy and raises chance of evading enemy's attack (including Super Attack) & chance of performing a critical hit by 6% for 1 turn"
        class="pl-2" id="superAttack" formControlName="superAttack" type="text">
      @if ( form.get('superAttack')?.dirty && form.get('superAttack')?.getError('required')) {
      <app-error errorMessage="super attack field required" />
      }
    </div>

  </div>

  <!-- Links -->
  <div>
    <div class="flex flex-col px-10 mt-5 w-full" formArrayName="links">
      <label class="pl-20 my-2 scroll-m-20 text-1xl font-extrabold tracking-tight lg:text-md" oriLabel>
        Links</label>
      @for (control of this.getLinkSkillSet().controls; track control; let index = $index) {
      <div class="flex gap-1 m-auto w-full px-20  " [formGroupName]="index">
        <select class="my-2 select flex-1" formControlName="link">
          @for (link of links; track $index) {
          <option class="bg-black" [value]="link.value">{{link.linkName}}</option>
          }
        </select>
        <button type="button" class="h-12 w-10 mt-2" [disabled]="index === 0" (click)="removeLinkSkill(index)" ubButton
          variant="destructive" size="icon">
          <ng-icon name="heroArchiveBoxXMark" class="h-4 w-4" />
        </button>
      </div>
      }
      <button type="button" class="h-12 w-10 mt-2 m-auto rounded-lg bg-green-900 hover:bg-green-800"
        (click)="addLinkSkill()" ubButton size="icon">
        <ng-icon name="heroPlus" class="h-4 w-4" />
      </button>
    </div>
  </div>

  <!-- Passive -->
  <div class="flex flex-col p-10 w-full" formArrayName="passivePart">
    @for (control of this.getPassiveParts().controls; track control; let index = $index)
    {
    <div class="flex flex-col m-auto w-full px-20 py-10 mt-5" [formGroupName]="index">
      <label class="my-2 scroll-m-20 text-1xl font-extrabold tracking-tight lg:text-md" oriLabel>Passive
        Condition
        Activation</label>
      <select class="my-2 select" formControlName="passiveConditionActivation">
        @for (effect of passiveConditionActivation; track $index) {
        <option class="bg-black" [value]="effect.value">{{effect.effect}}</option>
        }

      </select>
      <div class="flex gap-1 flex-col" formArrayName="effect">
        @for (control of this.getPassiveEffects(index).controls; track control; let index2 = $index)
        {
        <div [formGroupName]="index2">
          <label class="scroll-m-20 text-1xl font-extrabold tracking-tight lg:text-md" oriLabel>Effect</label>
          <div class="flex flex-1 gap-1 items-center justify-center">
            <div class="flex-1">
              <input class="mt-2 w-full pl-2" formControlName="effectDescription" placeholder="ATK & DEF + 200% ..." />
              @if ( this.getPassiveEffects(index).controls[index2].get('effectDescription')?.dirty &&
              this.getPassiveEffects(index).controls[index2].get('effectDescription')?.getError('required')) {
              <app-error errorMessage="Effect field required" />
              }

            </div>
            <select class="bg-yellow-400 text-xl text-black text-center mt-2 " formControlName="effectDuration" id="">
              @for (duration of effectDuration; track $index) {
              <option class="bg-yellow-400" [value]="duration.value">
                {{duration.duration}}
              </option>
              }

            </select>
            <button type="button" class="h-12 w-10 mt-2" [disabled]="index2 === 0"
              (click)="removePassiveEffect(index, index2)" ubButton variant="destructive" size="icon">
              <ng-icon name="heroArchiveBoxXMark" class="h-4 w-4" />
            </button>

          </div>

        </div>

        }
        <div class="flex">
          <button type="button" ubButton class="w-28 m-auto my-5 bg-white text-black hover:text-white"
            (click)="addPassiveEffect(index)">Add New
            effect</button>
          <button [disabled]="index === 0" type="button" ubButton variant="destructive" class="w-24 m-auto mt-5"
            (click)="removePassivePart(index)">Remove
            Part</button>

        </div>

      </div>
    </div>


    }
    <button type="button" ubButton class="bg-green-900 hover:bg-green-800 w-46 m-auto my-5"
      (click)="AddPassivePart()">Add new Passive
      Part</button>

  </div>
  <button [disabled]="!form.valid" type="submit" class="w-96 m-auto bg-white text-black hover:text-white"
    ubButton>Create</button>
</form>

<router-outlet />



<ng-container #card />